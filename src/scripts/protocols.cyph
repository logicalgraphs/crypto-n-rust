-- protocols in blockchains

match (n) detach delete n

LOAD CSV
FROM 'https://raw.githubusercontent.com/logicalgraphs/crypto-n-rust/main/data-files/blockaverse/protocols.tsv' as row
FIELDTERMINATOR '\t'
merge (p:Protocol { name: row[0] })
merge (b:Blockchain { name: row[1] })
merge (p)-[:ON { invested: row[2], value: row[3] }]->(b) 

-- invested has nulls

create (p:Portfolio { name: "protocols" })

match (p:Portfolio)
match (b:Blockchain)
merge (p)<-[:IN]-(b)
